{'body': 'This looks like a classic case of ARGB mixup.\nHave you ordered your bytes to paint "Alpha, Red, Green Blue"?\n\nbob.\n\nOn Apr 19, 2010, at 8:38 AM, Alexander CarÃ´t wrote:\n\n> Hello again,\n> \n> regarding my color problem I attached a screenshot of the actual image I get when mapping the pixels of a CGImage onto a QImage: The image is kind of blue/white (pillow should be red, pullover shuld be green and skin white).\n> \n> The full mapping sequence looks like this:\n> \n> *****************************\n> CGImageRef image = NULL;\n> \n> size_t width, height, rowBytes, bitsPerComponent;\n> CVPixelBufferLockBaseAddress( pixelBuffer, 0 );\n> rowBytes = CVPixelBufferGetBytesPerRow( pixelBuffer );\n> baseAddr = CVPixelBufferGetBaseAddress( pixelBuffer );\n> width = CVPixelBufferGetWidth( pixelBuffer );\n> height = CVPixelBufferGetHeight( pixelBuffer );\n> colorspace = CGColorSpaceCreateDeviceRGB();\n> CVBufferRetain( pixelBuffer );\n> provider = CGDataProviderCreateWithData( pixelBuffer, baseAddr, rowBytes *height, releaseAndUnlockThis );\n> image = CGImageCreate( width, height, 8, 32, rowBytes, colorspace, \n> kCGImageAlphaNoneSkipFirst, provider, NULL, true, kCGRenderingIntentDefault );\n> \n> unsigned char *rawData = new unsigned char[1000000];\n> unsigned char backup;\n> \n> CFDataRef data = CGDataProviderCopyData(CGImageGetDataProvider(image));\n> rawData = (unsigned char*) CFDataGetBytePtr(data);\n> \n> if (data != NULL){\n>  currentObject->displayImage = new QImage(rawData,320,240,QImage::Format_RGB32);   \n>  currentObject->update();\n> }   \n> *****************************\n> \n> I already changed the formats but this made it even worse. Furthermore, I did a manua byte swap of the raw data buffer (in case this might be an endian problem)<colorProblem.tiff>:\n> \n>  for (int i=0;i<100000;i=i+2){\n>    backup = rawData[i];\n>    rawData[i]=rawData[i+1];\n>    rawData[i+1] = backup;\n>  } \n> \n> but this painted swapped range in green.\n> \n> I anyone might know what the problem might be I\'d appreciate any hint.\n> \n> Thanks a lot in advance\n> \n> -- A l e x\n> \n> _______________________________________________\n> Do not post admin requests to the list. They will be ignored.\n> QuickTime-API mailing list      (QuickTime-API@lists.apple.com)\n> Help/Unsubscribe/Update your Subscription:\n> http://lists.apple.com/mailman/options/quicktime-api/robert_monaghan%40mac.com\n> \n> This email sent to robert_monaghan@mac.com\n\n _______________________________________________\nDo not post admin requests to the list. They will be ignored.\nQuickTime-API mailing list      (QuickTime-API@lists.apple.com)\nHelp/Unsubscribe/Update your Subscription:\nhttp://lists.apple.com/mailman/options/quicktime-api/mlsubscriber.tech%40csmining.org\n\nThis email sent to mlsubscriber.tech@csmining.org\n\n', 'subject': 'Re: color problem'}