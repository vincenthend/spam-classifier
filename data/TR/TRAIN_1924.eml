{'body': 'This looks like a classic case of ARGB mixup.\r\nHave you ordered your bytes to paint "Alpha, Red, Green Blue"?\r\n\r\nbob.\r\n\r\nOn Apr 19, 2010, at 8:38 AM, Alexander Car=F4t wrote:\r\n\r\n> Hello again,\r\n>=20\r\n> regarding my color problem I attached a screenshot of the actual image =\r\nI get when mapping the pixels of a CGImage onto a QImage: The image is =\r\nkind of blue/white (pillow should be red, pullover shuld be green and =\r\nskin white).\r\n>=20\r\n> The full mapping sequence looks like this:\r\n>=20\r\n> *****************************\r\n> CGImageRef image =3D NULL;\r\n>=20\r\n> size_t width, height, rowBytes, bitsPerComponent;\r\n> CVPixelBufferLockBaseAddress( pixelBuffer, 0 );\r\n> rowBytes =3D CVPixelBufferGetBytesPerRow( pixelBuffer );\r\n> baseAddr =3D CVPixelBufferGetBaseAddress( pixelBuffer );\r\n> width =3D CVPixelBufferGetWidth( pixelBuffer );\r\n> height =3D CVPixelBufferGetHeight( pixelBuffer );\r\n> colorspace =3D CGColorSpaceCreateDeviceRGB();\r\n> CVBufferRetain( pixelBuffer );\r\n> provider =3D CGDataProviderCreateWithData( pixelBuffer, baseAddr, =\r\nrowBytes *height, releaseAndUnlockThis );\r\n> image =3D CGImageCreate( width, height, 8, 32, rowBytes, colorspace,=20=\r\n\r\n> kCGImageAlphaNoneSkipFirst, provider, NULL, true, =\r\nkCGRenderingIntentDefault );\r\n>=20\r\n> unsigned char *rawData =3D new unsigned char[1000000];\r\n> unsigned char backup;\r\n>=20\r\n> CFDataRef data =3D =\r\nCGDataProviderCopyData(CGImageGetDataProvider(image));\r\n> rawData =3D (unsigned char*) CFDataGetBytePtr(data);\r\n>=20\r\n> if (data !=3D NULL){\r\n>  currentObject->displayImage =3D new =\r\nQImage(rawData,320,240,QImage::Format_RGB32);  =20\r\n>  currentObject->update();\r\n> }  =20\r\n> *****************************\r\n>=20\r\n> I already changed the formats but this made it even worse. =\r\nFurthermore, I did a manua byte swap of the raw data buffer (in case =\r\nthis might be an endian problem)<colorProblem.tiff>:\r\n>=20\r\n>  for (int i=3D0;i<100000;i=3Di+2){\r\n>    backup =3D rawData[i];\r\n>    rawData[i]=3DrawData[i+1];\r\n>    rawData[i+1] =3D backup;\r\n>  }=20\r\n>=20\r\n> but this painted swapped range in green.\r\n>=20\r\n> I anyone might know what the problem might be I\'d appreciate any hint.\r\n>=20\r\n> Thanks a lot in advance\r\n>=20\r\n> -- A l e x\r\n>=20\r\n> _______________________________________________\r\n> Do not post admin requests to the list. They will be ignored.\r\n> QuickTime-API mailing list      (QuickTime-API@lists.apple.com)\r\n> Help/Unsubscribe/Update your Subscription:\r\n> =\r\nhttp://lists.apple.com/mailman/options/quicktime-api/robert_monaghan%40mac=\r\n.com\r\n>=20\r\n> This email sent to robert_monaghan@mac.com\r\n\r\n _______________________________________________\r\nDo not post admin requests to the list. They will be ignored.\r\nQuickTime-API mailing list      (QuickTime-API@lists.apple.com)\r\nHelp/Unsubscribe/Update your Subscription:\r\nhttp://lists.apple.com/mailman/options/quicktime-api/mlsubscriber.tech%40csmining.org\r\n\r\nThis email sent to mlsubscriber.tech@csmining.org\r\n\r\n', 'subject': 'Re: color problem'}