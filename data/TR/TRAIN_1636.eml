{'body': '\n----- Original Message -----\n> Date: Mon, 12 Aug 2002 18:23:34 -0700\n> From: Chad Norwood <chad@cloudmark.com>\n> To: Sven <sven@dmv.com>\n> Cc: razor-users@example.sourceforge.net\n> Subject: [Razor-users] Re: Questions on miscellaneous errata and issues\n>\n> On 09/08/02 20:49 -0400, Sven wrote:\n> ) In tweaking my system to try to optimize the use of razor (this now from\na network/connection/etc standpoint, not so much from a philosphical stance\non what is or is not considered spam and who should decide it) I have come\nacross a couple issues that I hope I may be able to get some relief on ...\n> )\n> ) 1) What *exactly* does "Unable to connect to honor.cloudmark.com:2703;\nReason: Operation now in progress." mean ??? I have seen this error message\nsome 1700 times today (between 2 clustered servers) representing a little\nover 1% failure rate. In an enterprise level I was hoping for more along the\nlines of maybe one-tenth that .....\n>\n>   It\'s a network error - That string is not created by\n>   Razor Agents.  Its trying to connect and having trouble.\n>   1700 times seems abnormally high.  How many successful\n>   connections were there in the same timespan?\n>\n\nToday was not as bad ... apt.cloudmark was the server du jour and\nexperienced about 800 "Unable to connect .... Reason: Operation now in\nprogress" out of some 189,000 "bootup[1]"  or roughly 0.5% -- better than\nthe 1% before but still a bit higher than I would like. I suspect it is\nbecause a previous timeout from razor-agents has a process id that is being\nheld by an open milter socket. The process id\'s cycle, the number comes up\nagain and the error occurs as a duplicate pid occurs. I will tweak my milter\nsettings to shorten the total time to allow the socket to live per connect.\n\n>\n> ) 2) Related somewhat to question 1: is there (or will there be if\ncurrently not) a way of adjusting the timeout the setting for the\nrazor-check to await a response from the server it queries? I am running\nthis as a sendmail milter and adjusting the milter timeouts won\'t help if\nthe razor-check script times out first anyway ....\n>\n>   The timeout is hardcoded to 15 secs.\n>   No plans right now to make that an option.\n>   You can always edit the source - Core.pm.  :)\n\nIn looking at Core.pm I find a couple possible places where that code might\nbe. Is it:\n    my $select = new IO::Select ($sock);\n    my @handles = $select->can_read (15);\n    if ($handles[0]) {\n        $self->log (8,"Connection established");\n        my $greeting = <$sock>;\n        # $sock->autoflush; # this is on by default as of IO::Socket 1.18\n        $self->{sock} = $sock;\n        $self->{connected_to} = $server;\n        $self->{select} = $select;\n        $self->log(4,"$server >> ". length($greeting) ." server greeting:\n$greeting");\n\n        return 1 if $params{discovery_server};\n        unless ($self->parse_greeting($greeting) ) {\n            $self->nextserver or return $self->errprefix("connect2");\n            return $self->connect;\n        }\n        return 1;\n    } else {\n        $self->log (3, "Timed out (15 sec) while reading from\n$self->{s}->{ip}.");\n??????\nor\n    unless ($sock) {\n        $sock = IO::Socket::INET->new(\n                            PeerAddr => $server,\n                            PeerPort => $port,\n                            Proto    => \'tcp\',\n                            Timeout  => 20,\n                     );\n        unless ( $sock ) {\n            $self->log (3,"Unable to connect to $server:$port; Reason:\n$!.");\n            return if $params{discovery_server};\n            $self->nextserver or return $self->errprefix("connect1");\n            return $self->connect;\n        }\n    }\n??????\n[of course the latter reflects a differenct timeout setting altogether - one\npart for proxy, the other for non-proxy]\n\n>\n>\n> ) 3) What are the plans for fire.cloudmark, apt.cloudmark, ubik.cloudmark?\nIt seems that we have all these catalogue servers yet a good portion of the\ntime, only one is available or the last discovery ends up only listing one\n(currently honor.cloudmark) in the cataloge.lst file.\n>\n>   The system is designed so servers can be added and\n>   subtracted without the clients caring - if the razor\n>   client can\'t connect to a server, it re-discovers, getting\n>   all currently available servers and stores results locally.\n>\n\nI changed the default discovery period to every 12 hours in order to\ncompensate for the recent sporadic nature of the servers\' availability (I\nrealize that the issue was related to syncing and server upgrades .... but I\nmight as well play it safe for a while).\n\n>\n> ) 4) What would be the implications/requirements/caveats of hosting a\ncatalogue server or, at the minimum, a caching server (similar to the way\nmail-abuse.org, for example, does dns zone transfers of its rbl list -- I\nrealize that this is a completely different mechanism, but you get the point\nI am driving at here). I realize that there is an issue of polluting the\ncatalogue but perhpas there could be some way of certifying a catalogue\nserver? What type of bandwidth considerations are we looking at here? (It is\njust the signatures that are actually transferred across the pipes, is it\nnot?)\n>\n>   We are looking into releasing caching catalogue servers\n>   for those besides us to use.\n\nIf I can be of help or if you have details about to participate in this\nportion (caching or catalogueing), please let me know.\n\n>\n>\n> ) It really looks like there is a great potential here for a very workable\ntool and if I can get some of these issues addressed or can even be of some\nassistance, all the better .....\n> )\n> ) Sven Willenberger\n> ) Systems Administration\n> ) Delmarva Online, Inc.\n>\n>\n>   Thanks!\n>\n>   -chad\n>\n>\n>\n> --__--__--\n>\n> _______________________________________________\n> Razor-users mailing list\n> Razor-users@lists.sourceforge.net\n> https://lists.sourceforge.net/lists/listinfo/razor-users\n>\n>\n> End of Razor-users Digest\n\n\n\n-------------------------------------------------------\nThis sf.net email is sponsored by: Dice - The leading online job board\nfor high-tech professionals. Search and apply for tech jobs today!\nhttp://seeker.dice.com/seeker.epl?rel_code=31\n_______________________________________________\nRazor-users mailing list\nRazor-users@lists.sourceforge.net\nhttps://lists.sourceforge.net/lists/listinfo/razor-users\n\n\n', 'subject': 'Re: [Razor-users] Re: Questions on miscellaneous errata and issues'}