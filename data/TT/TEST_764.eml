{'body': 'On Sun, 21 Jul 2002 16:37:21 -0500 \nHal DeVore <haldevore@acm.org> wrote:\n\n>>>>>> On Fri, 19 Jul 2002, "J" == J C Lawrence wrote:\n\nJ> What would be great is if I could build the relevant comp file\nJ> dynamically at runtime.\n\n> Sure.  Use the "folder change" hooks.  Create a proc named\n> Hook_FolderChangeSomething (where "Something" is meaningful and likely\n> to be unique in the universe just in case you distribute this to\n> others).  Put the proc in a file in your ~/.tk/exmh directory,\n> regenerate the tclIndex, restart exmh.\n\n> In that proc you can do anything you want, like rewrite your\n> ~/Mail/comp file.\n\nYeah, that would work, tho there are race conditions and likely/possible\nugly side effects (eg unintentionally left-over comp files).  I\'ve ended\nup taking a very different route: TMDA (http://www.tmda.net).  In\nparticular I use TMDA outbound filters to add custom plus addresses to\nthe messages I send to specific lists.\n\nFor example, for the tmda-users list I want a From: address of\nclaw+tmda@kanga.nu, so the relevant outbound filter is:\n\n to tmda-users@libertine.org ext=tmda\n\nwhich rewrites my From: header transparently.  When I get next month\'s\nbatch of password reminders from Mailman lists I\'ll be running about\nresubscribing to each list either with a standard plus address or a\nTMDA-based sender address (ie an address which only the list in question\nis able to send mail to).\n\n\t\t\t\t  -+-\n\nGetting TMDA fully happy with nmh was a minor pain.  \n\nReasons:\n\n  nmh, like MH, by default delivers outbound mail via SMTP to port 25 on\n  a defined host.  The port number cannot be configured (it calls\n  getservbyname() which does a lookup against "smtp" in /etc/services).\n  Ergo, you are constrained to use tell nmh to use tmda-sendmail instead\n  of SMTP.\n\n  Using sendmail as the delivery method under MH instead of SMTP is not\n  recommended as is loses a number of useful bits of robustness in mail\n  delivery failure modes.  Further, when nmh is configured to use\n  sendmail instead of SMTP nmh\'s whom tool calls sendmail as follows:\n\n    .../sendmail/ -m -t -i -bv\n\n  which creates problems:\n\n    Postfix does not support "-bv" and returns in error\n\n    Exim does not support "-t" with "-bv" and returns in error\n\n    Don\'t mention Qmail.  I won\'t use it.\n\n  "whom" is far too useful as a component tool in MH to lose.  \n\n    It would be nice if someone gave the new crew working on nmh a shout\n    about this.  The "-bv" option to sendmail is pretty damned close to\n    being Allman sendmail specific and thus unfriendly to other MTAs.\n    Further there are many cases where it would be useful to configure a\n    non-standard port to deliver outbound mail to via SMTP.  nmh\'s\n    current insistence on only using port 25 (or as specified in\n    /etc/services) is a pain.\n\nI\'ve worked out a hack to use TMDA with Exim while retaining nmh\'s\n"whom" support using Exim\'s system filter:\n\n  0) Make sure that the following options are set in ~/.tmda/config:\n\n    DATADIR\n    ALLOW_MODE_640\n    CRYPT_KEY_FILE\n    FINGERPRINT\n\n  1) chgrp everything in and under ~/.tmda to group "mail".\n\n  2) Configure Exim as per the current TMDA HOW-TO.\n\n  3) Set the following options in exim.conf:\n\n    message_filter = "/etc/exim/filter"\n    message_filter_pipe_transport = address_pipe\n\n  4) /etc/exim/filter reads:\n\n    # Exim filter\n    testprint "local_part: ${local_part: $h_From:}"\n    testprint "domain: ${domain: $h_From:}"\n    if "$h_X-tmda-fingerprint:" is "" and \n       "${domain: $h_From:}" is "kanga.nu" and\n       "${if exists {/home/${local_part:$h_From:}/.tmda} {true}{false}}" is "true"\n    then\n      pipe "/usr/bin/tmda-inject -c /home/${local_part:$h_From:}/.tmda/config"\n      finish\n    endif\n\n  Yes, that assumes that all user directories are under /home and that\n  they use ~/.tmda/config instead of ~/.tmdarc.  Hack appropriately for\n  your setup.\n\nBasic explanation:\n\n  Exim sends all outbound mail thru the system filter (if one is\n  configured) before attempting delivery.  The above system filter\n  extracts the user from the From: address and pipes the message thru\n  that user\'s TMDA setup via tmda-inject.\n\n  The system filter runs as the same user as Exim, thus the requirement\n  for the chgrp mail.  If your Exim installation runs as a different\n  user, chgrp as appropriate.\n\n  It should be fairly easy to do something similar under Postfix, but I\n  haven\'t investigated that end.\n\nNotes:\n\n  This requires that all outbound mail that is to be processed with TMDA\n  has a From: header which references a local user (suffixes are fine),\n  and that the From: address is fully qualified with a known domain.  If\n  you\'re vhosting the above setup would be fairly trivial to extend for\n  other domains and $HOME paths.  I\'m not vhosting on my desktop and so\n  don\'t care.  You could also qualify on envelope or other headers if\n  you wish.\n\n  A nice side effect of this approach for those running shared mail\n  servers is that ALL users who have TMDA configs instantly get TMDA\n  support for their outbound mail -- and in a manner that is less\n  complex and less prone to end-user error than the typical TMDA\n  configuration.\n\nCaveat Emptor.  \n\n  ObNote: I\'ve also written a small patch against TMDA 0.58 to add a\n  "hold" delivery method (identical to "confirm" except it sends no\n  confirmation requests -- very useful for testing configs or doing\n  silent sidetracking of mail).\n\n-- \nJ C Lawrence                \n---------(*)                Satan, oscillate my metallic sonatas. \nclaw@kanga.nu               He lived as a devil, eh?\t\t  \nhttp://www.kanga.nu/~claw/  Evil is a name of a foeman, as I live.\n\n\n\n_______________________________________________\nExmh-users mailing list\nExmh-users@redhat.com\nhttps://listman.redhat.com/mailman/listinfo/exmh-users\n\n\n', 'subject': 'Re: Folder computed replcomps (and replgroupcomps'}