{'body': 'On Friday 07 May 2010 08:22:00 deloptes wrote:\r\n> Jozsi Vadkan wrote:\r\n> > Did anyone managed to boot from RAID1?\r\n> >\r\n> > Lenny gives this error message:\r\n> >\r\n> > "mdadm: no devices found for /dev/md0"\r\n> >\r\n\r\n> You\'ll need a small i.e. 20-30MB partition out of raid to boot from with\r\n> i.e. initrd which loads the md driver and your raid device becomes visible.\r\n\r\n\xa0 Just for the record, it actually *is* possible to boot off a partition\r\nthat\'s in RAID1, but you might have to use grub. \xa0The reason it works\r\nis because grub can read past the md-raid1 metadata without getting\r\nconfused -- since the raid is not running when grub is looking at the\r\ndisks, it only sees one of the two, but since they\'re mirrored, and\r\nsince grub doesn\'t *write* to the partition, everything works.\r\n\r\n\xa0 I have several production systems that do this.\r\n\r\n\xa0 It\'s a bit complicated to set up, but generally, it goes\r\nsomething like:\r\n\r\n\xa0 - Install a basic system onto one drive, with the correct\r\n\xa0 \xa0 \xa0 size of partition (call this /dev/sda1).\r\n\xa0 - Set up an "incomplete" RAID1 array, with one device and\r\n\xa0 \xa0 \xa0 one missing, with the second drive -- this is /dev/md0,\r\n\xa0 \xa0 \xa0 consisting of /dev/sdb1 and an empty slot.\r\n\xa0 - Configure /etc/mdadm/mdadm.conf, and re-build your initramfs\r\n\xa0 \xa0 \xa0 so that it has the md modules and knows about the array.\r\n\xa0 - Mount /dev/md0 somewhere and copy all the data off /dev/sda1 to it.\r\n\xa0 \xa0 \xa0 It\'s very important to get the *new* initramfs onto the array.\r\n\xa0 - Install grub in the bootloader of the 2nd drive. (The installer\r\n\xa0 \xa0 \xa0 already did this for the first one). This actually isn\'t\r\n\xa0 \xa0 \xa0 essential, but you may need it if/when /dev/sda fails.\r\n\xa0 - Boot on to the incomplete RAID array -- root=/dev/md0.\r\n\xa0 - Add /dev/sda1 to the array, and sync.\r\n\r\n\xa0 Now you have a bootable software raid-1 system.\r\n\r\n\xa0 I\'m not saying this solves the OP\'s problem, necessarily,\r\nbut it\'s perfectly possible. \xa0I\'ve never tried it with LILO\r\nor grub2, but I would think it would work.\r\n\r\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0-- A.\r\n-- \r\nAndrew Reid / reidac@bellatlantic.net\r\n\r\n\r\n-- \r\nTo UNSUBSCRIBE, email to debian-user-REQUEST@lists.debian.org \r\nwith a subject of "unsubscribe". Trouble? Contact listmaster@lists.debian.org\r\nArchive: http://lists.debian.org/201005071303.20994.reidac@bellatlantic.net\r\n\r\n\r\n', 'subject': 'Re: usb raid1 pendrive boot'}